# 智能计算系统

## 第1章 概述

以深度学习为代表的人工智能技术在飞速发展，人类已走到智能时代门槛边，正如每个时代都有其对应的物质载体作支撑（如工业时代的发动机，信息时代的通用处理器），智能时代必须要有核心物质载体作为支撑，这就是智能计算系统。

本章首先介绍人工智能的发展历史以及三类主要研究方法，其次介绍智能计算系统的发展历程并展望未来智能计算系统的发展，最后以一个驱动范例（图像风格迁移）简单介绍智能应用从智能算法到编程再到芯片上运行的过程。

算法会议：CVPR、ICML、NIPS、AAAI

人工智能技术分层：应用层、算法层、系统层（pytorch, tensorflow）、芯片层

人工智能应该培养人工智能（子）系统的设计者和研究者。

John Hennessy（计算机体系结构—量化研究方法的作者）、Jeff Dean

谷歌最令人瞩目的三个系统：Tensorflow、AlphaGo、TPU

更广阔的视野：量化、稀疏化、轻量级的模型，不仅仅关注精度。

美国计算机TOP4高校：Stanford、CMU、UC Berkley、MIT

智能计算系统是智能的物质载体。现阶段的智能计算系统通常是集成CPU和智能芯片的异构系统，软件上通常包括一套面向开发者的智能计算编程环境（包括编程框架（pytorch, tensorflow）和编程语言（CUDA、BCL））。

智能计算系统的形态：超级计算机、数据中心、智能手机、嵌入式设备。

CCF A类会议：ISCA

深度学习花书的作者：Bengio

课程目的：融汇贯通地理解智能计算完整软硬件技术栈（包括基础智能算法、智能计算编程框架、智能计算编程语言、智能芯片体系结构等）。

前置课程：C/C++，计算机组成原理，算法导论（机器学习）。

应用驱动、全栈贯通的课程体系：智能算法、编程语言、系统软件、体系结构。

人工智能：强人工智能（通用人工智能）、弱人工智能。

人工智能三个流派：

* **行为主义**：基于控制论，构建感知-动作型控制系统。相当于人的小脑，包括强化学习的方法。
* **符号主义**：基于符号逻辑的方法，用逻辑表示知识和求解问题。当年人工智能最主流的方法。例：一阶谓词逻辑。理论上符号主义可以解决所有问题，但是它在逻辑、常识、求解器方面存在问题。逻辑：未找到能表述世间所有知识的简洁逻辑体系；常识：无穷无尽的常识；求解器：命题逻辑判定NP完全，一阶谓词逻辑不可判定。符号主义最本质的问题是只考虑了理性认识的智能。人类的智能包括感性认识（感知）和理性认识（认知）两个方面。
* **连接主义**：基于大脑中神经元细胞连接的计算模型，用人工神经网络来拟合智能行为。人工神经网络：
  * 第一代，单层感知机；
  * 第二代，MLP；
  * 第三代，深度神经网络；
  * 如今，深而大的深度神经网络。ResNet：152层。

深度学习的局限性：

* 泛化能力有限
* 缺乏推理能力
* 缺乏可解释性
* 鲁棒性欠佳

现今采用异构智能计算系统的主要原因：近十年来通用CPU的计算能力增长近乎停滞，而智能计算能力的需求在不断以指数增长，二者形成了剪刀差。

> 寒武纪深度学习处理器能够以比通用CPU低一个数量级的能耗，达到100倍以上的智能处理的速度。

异构系统在提高性能的同时，也带来了编程上的困难。

* 智能计算系统一般会集成一套编程环境，方便程序员快速便捷地开发高能效的智能应用程序；
* 常用的深度学习编程框架包括TensorFlow和MXNet等；
* 深度学习编程语言包括CUDA语言和BCL语言等。

三代智能计算系统：

* 第一代智能计算系统：1980年代，面向符号主义智能处理的专用计算机（Prolog机，LISP机）；
* 第二代智能计算系统：2010年代，面向连接主义智能处理的专用计算机（深度学习计算机）；![image-20220118204944503](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220118204944503.png)
* 第三代智能计算系统：未来强人工智能/通用人工智能的载体。

第三代智能计算系统展望：

* 具有近乎无限的计算能力，会给人工智能带来什么？
* 从奴仆到主人：第三代智能计算系统不再是智能算法的加速工具；
* 它将是通用人工智能（强人工智能）发育的沙盒虚拟世界。
  * 大量独立的智能主体，足够丰富的虚拟世界，以及背后的无限计算能力；
  * 智能主体将在其中成长，通过和环境的交互，形成感知、认知和逻辑能力，甚至理解虚拟世界、改造虚拟世界，从而具备通用智能。

第三代智能计算系统探索的总体思路：具备全面感知能力和超大规模硬件的原始智人是怎样一步步获得智能的？

* 体系结构：面向海量并发认知智能计算线程和超大规模虚拟环境的计算机和芯片；
* 算法：有线延迟的认知智能算法，能自主产生语言和文字，从本能之上建立起自己的知识图谱，打通感知到逻辑的鸿沟；
* 编程框架，操作系统，网络等等都将为之改变。

Driving Example：从一个例子开始，串起本课程各个章节。

风格迁移“星空”：

* 输入

* 建模

  * 神经网络基础
    * 颜色/纹理/形状特征
    * 监督/无监督
    * Sigmoid/ReLU/tanh
    * Forward Propagation，Back Propagation
    * 最优化
  * 深度学习
    * 传统模式识别：手工提取特征、训练分类器；
    * 深度学习：就是多层人工神经网络，深度学习最重要的作用是表征学习，学习层次化的特征（底层特征、中层特征、高层特征，训练分类器），”深度“这词指的就是很多层。
    * 

* 实现

  * 编程框架：将深度学习算法中的基本操作封装成一系列组件，帮助研究人员更简单的实现已有算法，或设计新的算法。这一系列深度学习组件，即构成一套深度学习框架。以TensorFlow为例：1、构建数据流图，描述计算过程；2、执行数据流图，获得计算结果。TensorFlow、dmlc mxnet、caffe/caffe2、torch/Pytorch。
  * Bang：Bang是寒武纪提出的异构编程语言，它是基于C语言的扩展，简单易学，同时提供了丰富高效的编程接口，高效实现编程框架所需的算子；深度学习算法的实现人员使用Bang语言将神经网络的基本操作实现为能在寒武纪平台上运行的程序，以供编程框架调用。

* 运行

  * 架构基础
  * 架构设计
  * 标准与评测

* 输出

  * 运行环境搭建。硬件环境：采用寒武纪系列智能加速卡，国内首款自主知识产权的智能处理器，支持所有现存的人工智能算法（包括但不限于CNN/DNN/DBN/RNN/LSTM/SOM/RCNN/Faster-RCNN/DeepID/YOLO等），相比传统的通用通用处理器CPU，能有效提升100倍，广泛应用在手机和服务器中。

  * 运行与调试。**代码的开发及编译**：串口调试、配置网络文件系统；**结果测试**：模型训练、性能剖析、系统监控。

  * 应用与开发。**智能应用依赖库的开发**：Cambricon Neuware机器学习库（Cambricon Neuware Machine Learning Library，CNML）提供了一套高效、通用、灵活、可扩展的编程接口，用于在智能加速卡上加速各种机器学习/深度学习算法；**数据预处理**；**人工智能网络运行**；**运行结果的后处理**。

    

## 第2章 神经网络基础

神经网络是一种机器学习算法，经过70多年的发展，逐渐成为人工智能的主流。例如，本课的驱动范例——图像风格迁移，一般就是基于神经网络实现的。本章首先从线性回归开始，逐步介绍机器学习和神经网络的基本原理，然后介绍神经网络的训练过程，以及提升神经网络训练精度的一些手段，最后介绍神经网络的交叉验证方法。

包含关系：人工智能-机器学习-神经网络-深度学习

机器学习：

* 机器学习是对能通过经验自动改进的计算机算法的研究（Michell）；
* 机器学习是用数据或以往的经验，以此提升计算机程序的能力（Alpaydin）;
* 机器学习是研究如何通过计算的手段，利用经验来改善系统自身性能的一门学科（周志华）。

![image-20220119124320462](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119124320462.png)

纵向是训练的过程，横向是预测过程。

符号说明：

> 输入数据：$x$
>
> 真实值（实际值）：$y$
>
> 计算值（模型输出值）：$\hat{y}$
>
> 模型函数：$H(x)$
>
> 激活函数：$G(x)$
>
> 损失函数：$L(x)$
>
> 标量：斜体小写字母$a、b、c$
>
> 向量：黑斜体小写字母$\bold{a、b、c}$
>
> 矩阵：黑斜体大写字母$\bold{A、B、C}$

从最简单的线性回归模型开始，直至搭建出一个完整的神经网络架构。

什么是回归（regression）和线性回归？为什么从线性回归开始？最简单、研究最充分的回归。

单变量线性回归模型（一元回归模型），线性回归可以找到一些点的集合背后的规律，一个点集可以用一条直线来拟合，这条拟合出来的直线的参数特征，就是线性回归找到的点集背后的规律。
$$
H_w(x)=w_0+wx\\x:Feature; H(x):hypothesis
$$
多变量线性回归模型：
$$
H_w(x)=w_0+w_1x_1+w_2x_2\quad 2个特征\\
H_w(x)=\sum_{i=0}^nw_ix_i=\hat{\bold{w}}^T\bold{x}\\
\hat{\bold{w}}=[w_0;w_1;...;w_n],\\
\bold{x}=[x_0;x_1;...;x_n],\quad x_0=1
$$
线性回归拟合得好不好？

模型预测值$\hat{y}$与真实值$y$之间存在误差 $\epsilon=y-\hat{y}=y-\hat{\bold{w}}^T\bold{x}$

$\epsilon$满足$N(0,\sigma^2)$的高斯分布：
$$
p(\epsilon)=\frac1{\sqrt{2\pi\sigma}}\exp(-\frac{\epsilon^2}{2\sigma^2})\\
p(y|\bold{x};\hat{\bold{w}})=\frac1{\sqrt{2\pi\sigma}}\exp(-\frac{(y-\hat{\bold{w}}^T\bold{x})^2}{2\sigma^2})
$$
最大似然估计通过求最大似然函数，得到预测值与真实值之间误差尽量小的目标函数。

损失函数:
$$
L(\hat{\bold{w}})=\frac12\sum_{j=1}^m(H_w(x_j)-y_j)^2=\frac12\sum_{j=1}^m(\hat{\bold{w}}^T\bold{x}-y_j)^2
$$
目标：求出参数$\hat{\bold{w}}$，使得损失函数$L(\hat{\bold{w}})$取值最小。

寻找参数$\hat{\bold{w}}$，使得$L(\hat{\bold{w}})$最小。最小二乘法（解析的方法）？

迭代法（梯度下降法）寻找参数：

* 初始先给定一个$\hat{\bold{w}}$，如$\bold{}$向量或随机向量；
* 沿着梯度下降的方向进行迭代，使更新后的$L(\hat{\bold{w}})$不断变小；

$$
\bold{\hat{w}=\hat{w}-\alpha\frac{\partial L(\hat{w})}{\partial \hat{w}}}\\
\bold{\alpha}称为学习率或步长
$$

迭代至找到使得$L(\hat{\bold{w}})$最小的$\hat{\bold{w}}$值停止，从而得到回归模型参数。

![image-20220119155651281](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119155651281.png)

单层感知机不能解决线性不可分问题。

机器学习领域，人工神经元是一个包含输入、输出与计算功能的模型。不严格地说，其**输入**可类比为生物神经元的**树突**，其**输出**可类比为神经元的**轴突**，其**计算**可类比为**细胞体**。

感知机（Perceptron）模型$H(\bold{x})=sign(\bold{w^{T}x}+b)$对应一个超平面$\bold{w^{T}x}+b=0$，模型参数是$(\bold{w},b)$。感知机的目标是找到一个$(\bold{w},b)$，将线性可分的数据集T中的所有的样本点正确地分为两类。
$$
H(\bold{x})=sign(\bold{w^{T}x}+b)\\
f(n) =
\begin{cases}
+1, & x\geq0\\
-1, &x\leq0
\end{cases}
$$
寻找损失函数，并将损失函数最小化。

超平面：二维空间的超平面是一维直线，三维空间的超平面是二维平面，四维空间的超平面是三维的体。

全使用这种线性激活函数，整个神经网络不能求解线性不可分问题。

![image-20220119163213106](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119163213106.png)

距离：非负，自反，三角不等式

![image-20220119163422318](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119163422318.png)

![image-20220119163535047](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119163535047.png)

![image-20220119163837940](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119163837940.png)

![image-20220119164024970](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164024970.png)

![image-20220119164046126](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164046126.png)

![image-20220119164058020](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164058020.png)

总共12个参数

![image-20220119164148967](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164148967.png)

两层神经网络比五层神经网络需要更多的参数。

![image-20220119164449431](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164449431.png)

![image-20220119164510091](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164510091.png)

![image-20220119164601731](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164601731.png)

![image-20220119164632399](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164632399.png)

![image-20220119164720425](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164720425.png)

![image-20220119164743315](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164743315.png)

![image-20220119164818354](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119164818354.png)

损失函数对每个参数求导，求出每个参数对损失函数所需要负的责任。

![image-20220119165359055](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165359055.png)

![image-20220119165420338](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165420338.png)

![image-20220119165453499](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165453499.png)

![image-20220119165501901](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165501901.png)

![image-20220119165756659](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165756659.png)

![image-20220119165810449](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165810449.png)

![image-20220119165956921](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119165956921.png)

![image-20220119170029208](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170029208.png)

![image-20220119170107327](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170107327.png)

![image-20220119170210609](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170210609.png)

![image-20220119170243740](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170243740.png)

![image-20220119170251324](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170251324.png)

![image-20220119170334532](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170334532.png)

![image-20220119170436862](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170436862.png)

![image-20220119170442993](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170442993.png)

![image-20220119170507455](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170507455.png)

隐层数目，隐层神经元的数量

![image-20220119170606412](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170606412.png)

automl 自动找多少个隐层，隐层多少个神经元

![image-20220119170839409](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119170839409.png)

建立在链式法则求导的基础上，所以必须具有可微性

上一层的输出是下一层的输入。

激活函数输出无限，梯度特别大，学习率要十分小。

![image-20220119171255519](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119171255519.png)

把输出变成有限范围

缺点：虽然是对称的，但是对称的点不在0上，输出的平均值不等于0，下一层输入的值有偏移，影响神经网络的收敛；算e的-x方指数运算效率低；饱和性问题及梯度消失问题。左右两边平缓，输入x比较大或者比较小，梯度接近于0，有一个梯度接近于0，整个梯度都会非常接近于0，参数更新非常缓慢。sigmoid导数范围处于一个比较有限的范围，一般来说小于1，链式法则求偏导数，很多小于1的数相乘，最后趋近于0，随着神经网络层数增多，梯度非常接近于0，最后梯度消失，网络训不动了。尤其是很靠近输入的那些权重。



![image-20220119191131154](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191131154.png)

![image-20220119191231137](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191231137.png)

![image-20220119191414990](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191414990.png)

PRelu里的$\alpha$不调整就是Leaky Relu

![image-20220119191554914](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191554914.png)

![image-20220119191652805](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191652805.png)

loss function

![image-20220119191721382](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191721382.png)

![image-20220119191833332](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191833332.png)

![image-20220119191856428](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119191856428.png)

对数里的是计算值，另一个是实际值

![image-20220119192939390](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119192939390.png)

sigmoid 的导数被约掉了，这样就不容易遇到梯度消失的问题。

![image-20220119193119104](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119193119104.png)

损失函数一定是一个数（值）。

![image-20220119193325478](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119193325478.png)

![image-20220119193446805](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119193446805.png)

![image-20220119195242954](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195242954.png)

![image-20220119195320747](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195320747.png)

不仅让$y$和$\hat{y}$之间的差减小，还让$w_3$和$w_4$也变得小一些。

![image-20220119195532531](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195532531.png)

![image-20220119195621462](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195621462.png)

![image-20220119195639526](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195639526.png)

导数特别大，扭曲得特别厉害。

![image-20220119195813862](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119195813862.png)

稀疏化：在训练过程中尽可能让神经网络的很多权重都变成零。权重为0，神经元的值乘以权重就可以不用计算了。稀疏化可以让整个神经网络的权重的百分之九十都为0。乘法的计算降低百分之九十。

![image-20220119200209164](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200209164.png)

![image-20220119200249230](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200249230.png)

![image-20220119200340522](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200340522.png)

![image-20220119200403802](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200403802.png)

![image-20220119200414559](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200414559.png)

使用训练好的神经元进行推理时，所有的神经元都是需要考虑的。训练过程中随即丢掉一些神经元，暂时不考虑。

![image-20220119200647962](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119200647962.png)

训练集：上课习题

测试集：考试题

![image-20220119201426785](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119201426785.png)

样本比较时，使用交叉验证。

![image-20220119201451293](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119201451293.png)

![image-20220119201535557](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119201535557.png)

![image-20220119201627151](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119201627151.png)

交叉验证的好处：在训练集上效果比较好，充分证明模型及训练方法的泛化能力较好，是比较鲁棒的。避免了把测试数据和训练数据混在一起，避免了打哪指哪，避免了考试只靠做过的题目，更好地反映一个神经网络算法模型到底有没有泛化使用的效果。

![image-20220119201844851](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220119201844851.png)

## 第3章 深度学习

本章首先介绍最基本的适合图像处理的卷积神经网络。在此基础上，介绍如何利用卷积神经网络做图像分类；随后，本章会介绍基于卷积神经网络的图像目标检测算法（包括算法是如何发展起来的），有助于大家遵循相关脉络设计新的算法。在最后，我们会介绍长短期记忆模型以及一种比较新颖的深度学习技术——生成对抗网络，最后我们将具体介绍如何用深度学习实现图像风格迁移这一具体案例。本章通过分析经典深度学习算法，学习将基础神经网络应用到实际场景，并逐步优化实现工业级应用的过程。

正则化避免过拟合，交叉验证判断是否遇到过拟合。

![image-20220120112636579](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120112636579.png)

80%是视觉输入，20%是文字语音输入

![image-20220120112729242](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120112729242.png)

生成对抗网络GAN是最近10年来最有意思的技术。

![image-20220120112930778](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120112930778.png)

输出并不多

![image-20220120113018683](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120113018683.png)

神经网络可能有几百层，每层有数以万计的神经元，模型会有非常多的权重，会导致过拟合

![image-20220120113245358](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120113245358.png)

![image-20220120113410071](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120113410071.png)

最经典的CNN

卷积层每一组都有特定的模板去找特定的特征。模板在图像的不同位置都是共享的。

pooling使图像的尺寸变小。卷积和池化使特征图的尺寸不断变小。具体特征的数量不断增加。

最后是全连接层。全连接层最后是softmax，把最可能的结果挑选出来。

卷积层和池化层主要是提取特征，真正分类是全连接层。

![image-20220120114721462](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120114721462.png)

卷积层在深度学习算法或者说卷积神经网络里占时最多的层。

![image-20220120114844050](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120114844050.png)

![image-20220120114956619](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120114956619.png)

输入特征图$*$卷积模板（卷积核）

3个输入的特征图   最后累加起来

![image-20220120115159288](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120115159288.png)

![image-20220120115216932](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120115216932.png)

多输入特征图 单输出特征图

![image-20220120115517903](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120115517903.png)

输出feature map

![image-20220120115824437](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120115824437.png)

![image-20220120115945448](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120115945448.png)

在边上补一圈0，不希望被动图像减小。

$stride=2$ 输出特征图大小减半。

$stride=3$ 输出特征图大小变为输入特征图的$1/3$。

![image-20220120120322990](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120120322990.png)

每个卷积模板有$f^2$个权重

p：旁白补一圈，f：卷积核的大小 s：移动的步长

![image-20220120124735366](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120124735366.png)

还有几何平均pooling，能用最大池化、平均值池化就挺好，其他的硬件实现太麻烦。

![image-20220120125013108](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120125013108.png)

Softmax拉大贫富差距

最大的数接近于1，其他的数接近于0。

![image-20220120125347007](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120125347007.png)

整个卷积神经网络从小范围简单特征一步一步抽取，最后到大范围复杂特征，最后到全局特征的抽取过程。

![image-20220120125622816](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120125622816.png)

n个卷积层pooling层，全连接层，最后送到softmax里

![image-20220120125756103](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120125756103.png)

ICML

![image-20220120125834473](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120125834473.png)

深层结构就能比较好地完成这种局部到整体的层次化的理解，一个复杂特征往往由多个简单特征组成，

层次化的结构适合从局部到整体逐步理解图像，

![image-20220120152643905](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120152643905.png)

Alexnet、VGG、Googlenet、resnet、

imagenet比赛 imagenet测试集

提高国际学术影响力的诀窍：测试集、开放开源的实验平台

![image-20220120154815092](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120154815092.png)



![image-20220120154830689](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120154830689.png)

11$*$11的比较大的卷积核，卷积stride是4，224$*$224到55$*$55，5$*$5的卷积核，128个feature map，最后做1000类物体的分类

![image-20220120155424227](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120155424227.png)

![image-20220120155602171](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120155602171.png)

一个位置可能同时参与多个特征，LRN后可能会适得其反。

![image-20220120160417477](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120160417477.png)

![image-20220120160502671](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120160502671.png)

错误率从25%-16%

![image-20220120160613099](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120160613099.png)

从8层到16层还是比较有挑战的。层数多了会遇到很多问题，比如有可能梯度爆炸，但是更多的时候可能遇到梯度消失。loss function在离损失函数比较近的一两层参数可能训练得比较好。但是16/19层，离输出近的层的权重的偏导实在是太小了，训练不动。

![image-20220120161056824](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120161056824.png)

先训练11层的CNN-VGGA，保留作为更深神经网络的前四个卷积层和三个全连接层权重的初始值，其余层的权重随机初始化。然后对16层的神经网络完整地进行重新训练。

![image-20220120162229714](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120162229714.png)

后来基本不用LRN了。

top5的错误率是指给一个图片猜5个结果，真实值在这5个里面，认为是正确的。

这种VGG的层数也是有极限的19层，层数再增多，就不行了。

**批判性的心态看论文。**

![image-20220120162633020](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120162633020.png)

经验：应该用一些比较小的卷积核，而不是用一些大的卷积核。

![image-20220120170126604](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120170126604.png)

一层5$*$5的卷积核可以用两层3$*$3的卷积核替代。

![image-20220120170519125](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120170519125.png)

做同样的事情，权重的数量变少，计算量/存储变小了，过拟合的可能性也变小了，算的又快又准。从VGG开始逐步开始使用小的3$*$3卷积核。

![image-20220120170832086](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120170832086.png)

![image-20220120170936452](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120170936452.png)

![image-20220120171657011](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120171657011.png)

有多种不同的卷积层、池化层。

![image-20220120171952685](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120171952685.png)

降维：输入feature map的数量多于输出feature map的数量

升维：输入feature map的数量少于输出feature map的数量

多个输入特征图同一个位置的数/神经元，做一个全连接的计算，得到的是输出feature map的一点。与LRN有一点相似，LRN可调的地方很少。1$*$1的卷积有很多可以调整的地方。

![image-20220120172520060](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120172520060.png)

乘法次数和参数数量显著减少了一个数量级。1$*$1的卷积把输入的256个特征图变成了32个特征图。瓶颈层之前之后的特征图都比瓶颈层的特征图要多。

![image-20220120173320815](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120173320815.png)

开始特征图数量少尺寸大，后面特征图大小越来越小、数量越来越多。

inception侧面的辅助分类网络

![image-20220120173556993](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120173556993.png)

旁路出一个结果出来，观察层，可以看到比较深的网络里的东西，深层神经网络最麻烦的地方是很靠近输入层的地方导数非常小，很难训练得动。通过旁路比较快得调整靠近输入层的网络权重。

使用时丢掉辅助分类网络。

![image-20220120174329837](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120174329837.png)

![image-20220120174353681](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220120174353681.png)

一般在进行神经网络训练之前，要对输入数据进行归一化处理，神经网络的训练过程很大程度上在学习输入数据的分布情况，一旦训练数据和测试数据不一样，网络对测试样本的适应/泛化能力大大下降。每一批训练数据的分布都不一样的话，网络在每一次迭代都去学习/适应不同的分布，大大会降低网络的训练速度和效率。这就是Batch Normalization的出发点。会在一个batch很多组不同的训练样本之间，把激活层的输入进行调整成正态分布，在样本之间做一个normalization，使得其服从正态分布。

正态分布参数是可以调节的，$\gamma$是scale，$\beta$是shift，$\gamma$、$\beta$到底是多少，需要在训练时进行调节，动态适应层的具体情况。Batch Normalization和过去技术很大的不一样，过去的调参优化技术在样本训练过程内部去优化，Batch Normalization在batch内部的不同样本之间把数据拿出来看看，然后根据不同样本的情况作normalization，

![image-20220121090335395](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121090335395.png)

学习率调大五倍，训练速度快15倍，精度也提升了。

![image-20220121090523333](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121090523333.png)

9个参数变成6个参数。正方形卷积到长条形卷积。

![image-20220121090714929](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121090714929.png)

![image-20220121090927630](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121090927630.png)

15年的resnet

![image-20220121091031649](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121091031649.png)

神经网络收敛到局部最优点，训不动了。resnet如何避免神经网络退化。

![image-20220121091254813](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121091254813.png)

![image-20220121091444667](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121091444667.png)

这样H(x)对x求偏导会有一个基础值，这样梯度不至于消失。

![image-20220121094427782](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121094427782.png)

层数越来越深，卷积核的大小越来越小，精度越来越高，准确度越来越低

输出处的损失函数能够更快地把误差传播到离输入很近层的参数

![image-20220121095948423](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121095948423.png)

检测不仅要分类，把所有物体尽可能检测出来，还要标记位置。

![image-20220121100215650](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121100215650.png)

交并比>0.5是一个比较准确的定位。

![image-20220121100346593](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121100346593.png)

选择更多的样本N，宁可错杀一千，绝不错过一个。

![image-20220121101116771](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101116771.png)

![image-20220121101330594](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101330594.png)

![image-20220121101408939](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101408939.png)

![image-20220121101534616](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101534616.png)

算出总的面积就是类A的AP。各类之间取平均是mAP。

![image-20220121101653410](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101653410.png)

两步走的算法相对来说准确率高一些，但是更费时间。

![image-20220121101753071](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121101753071.png)

![image-20220121104855690](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121104855690.png)

![image-20220121104951618](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121104951618.png)

![image-20220121111713281](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121111713281.png)

![image-20220121111747009](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121111747009.png)

![image-20220121111859146](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121111859146.png)

![image-20220121111909384](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121111909384.png)

![image-20220121112014242](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121112014242.png)

![image-20220121112145766](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121112145766.png)

![image-20220121112230522](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121112230522.png)

![image-20220121112644493](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121112644493.png)

用神经网络逐步把计算机视觉传统的东西给替代掉。

![image-20220121112749146](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121112749146.png)

有softmax的一路是判断候选框是前景还是背景，没有softmax的一路是确定候选框的位置的。



![image-20220121113532550](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121113532550.png)

feature map每个位置输出 6k 个参数。

![image-20220121113815996](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121113815996.png)

![image-20220121113844094](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121113844094.png)

一阶段的速度快，精度要差一些。

![image-20220121113911784](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121113911784.png)

![image-20220121113926006](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121113926006.png)

![image-20220121114030404](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114030404.png)

![image-20220121114055472](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114055472.png)

![image-20220121114140532](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114140532.png)

![image-20220121114238706](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114238706.png)

![image-20220121114248985](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114248985.png)

![image-20220121114319753](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114319753.png)

![image-20220121114428887](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114428887.png)

![image-20220121114446967](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114446967.png)

![image-20220121114533770](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121114533770.png)

ICCV CVPR

序列神经网络模型适合做连续的东西

![image-20220121131827080](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121131827080.png)

![image-20220121131839523](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121131839523.png)

![image-20220121131910578](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121131910578.png)

![image-20220121131929582](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121131929582.png)

h起到了记忆的作用。

![image-20220121152044725](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121152044725.png)

神经图灵机

![image-20220121152355565](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121152355565.png)

输入来自于特定时刻，输出可能是很多个不同时刻。

![image-20220121152500114](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121152500114.png)

![image-20220121152540185](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121152540185.png)

![image-20220121154254609](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154254609.png)

这是RNN记忆有限的原因。

![image-20220121154419409](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154419409.png)

![image-20220121154433217](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154433217.png)

记住过去应该长期记住的东西，但是不能记住太多。

海马体负责短期记忆，前额叶负责长期记忆，睡觉的时候短期记忆变成长期记忆。

![image-20220121154733278](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154733278.png)

在h之外又加了一个c

![image-20220121154820853](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154820853.png)

![image-20220121154852021](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154852021.png)

![image-20220121154918232](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154918232.png)

![image-20220121154949790](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121154949790.png)

生成对抗网络解决小样本环境下的问题。

![image-20220121162001676](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121162001676.png)

![image-20220121162108951](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121162108951.png)

有两个网络生成网络、判别网络，生成网络伪造出一些样本，判别网络判别是网络是伪造出来的还是真实的。和苏格拉底的辩证法有相似之处。通过辩证得到事务的真理。

![image-20220121162803420](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121162803420.png)

两个网络互相辩论、互相对抗，最后生成网络生成越来越真实的样本，辨别网络变得越火眼金睛。

![image-20220121163054165](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121163054165.png)

生成网络训练过程判别是假的，通过梯度下降方式调整生成网络。送到判别网络训练过程中，判别网络判别不对，调整判别网络。这是迭代过程，调整虚红线框里的网络。

![image-20220121163552563](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121163552563.png)

最终的训练目标是有一个最好最火眼金睛的判别器，生成器生成的样本不被判别器发现出来。

![image-20220121163925987](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121163925987.png)

![image-20220121164128694](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164128694.png)

![image-20220121164223577](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164223577.png)

![image-20220121164326457](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164326457.png)

![image-20220121164339957](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164339957.png)

![image-20220121164708213](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164708213.png)

![image-20220121164735468](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164735468.png)

![image-20220121164745620](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121164745620.png)

![image-20220121165532623](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121165532623.png)

![image-20220121170634859](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121170634859.png)

![image-20220121170747148](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121170747148.png)

![image-20220121170826697](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121170826697.png)

![image-20220121170853990](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121170853990.png)

![image-20220121170941907](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121170941907.png)

![image-20220121171219766](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121171219766.png)

![image-20220121171303160](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121171303160.png)

![image-20220121171455579](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121171455579.png)

## 第4章 编程框架（怎么用？）

第四章将学习到实现深度学习算法所使用的编程框架的简单用法。编程框架在整个智能计算系统中起着承上启下的作用，在某种意义上像信息产业里的操作系统，是智能计算系统中非常关键的核心枢纽。本章首先介绍深度学习编程框架的概念及作用，随后介绍目前应用最广的编程框架 TensorFlow 的基本概念及编程模型，最后通过程序示例来介绍如何基于 TensorFlow 实现深度学习的预测和训练。

![image-20220121172006916](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121172006916.png)

为什么需要编程框架？

深度学习算法得到广泛关注，越来越多的公司、程序员需要使用深度学习算法。

![image-20220121172204270](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121172204270.png)

书里每多一行公式，读者就会少一百。

有必要将算法中的常用操作封装成组件提供给程序员，以提高深度学习算法开发效率。

![image-20220121175021330](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121175021330.png)

![image-20220121175130541](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121175130541.png)

![image-20220121175212477](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121175212477.png)

![image-20220121192645676](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121192645676.png)

![image-20220121192700246](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121192700246.png)

TensorFlow是目前使用人数最多、影响最大的编程框架。

![image-20220121192910253](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121192910253.png)

![image-20220121192951183](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121192951183.png)

![image-20220121193020021](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193020021.png)

![image-20220121193124301](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193124301.png)

![image-20220121193236905](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193236905.png)

![image-20220121193255648](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193255648.png)

![image-20220121193305814](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193305814.png)

caffe贾杨清

![image-20220121193555886](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193555886.png)

![image-20220121193744036](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121193744036.png)

tensor是高维数组。

![image-20220121194947630](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121194947630.png)

![image-20220121195041344](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121195041344.png)

![image-20220121195155141](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121195155141.png)

计算图是静态的，只是描述了节点之间的关系，并没有真正去执行。

![image-20220121195500148](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121195500148.png)

![image-20220121195715651](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121195715651.png)

![image-20220121200100951](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121200100951.png)

![image-20220121200124931](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121200124931.png)

![image-20220121200152280](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121200152280.png)

![image-20220121202704207](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121202704207.png)

![image-20220121202727861](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121202727861.png)

![image-20220121202853646](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121202853646.png)

![image-20220121203424237](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121203424237.png)

![image-20220121203945425](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121203945425.png)

![image-20220121204058986](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121204058986.png)

![image-20220121204128658](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121204128658.png)

![image-20220121204203211](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121204203211.png)

![image-20220121205623259](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121205623259.png)

第一个是它的名称，第二个是它的形状，第三个是它的数据类型

![image-20220121212648440](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212648440.png)

![image-20220121212702607](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212702607.png)

![image-20220121212720000](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212720000.png)

![image-20220121212732030](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212732030.png)

![image-20220121212758749](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212758749.png)

![image-20220121212826632](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220121212826632.png)

![image-20220122090422947](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090422947.png)

![image-20220122090503454](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090503454.png)

![image-20220122090530192](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090530192.png)

![image-20220122090616626](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090616626.png)

![image-20220122090627226](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090627226.png)

![image-20220122090838349](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090838349.png)

![image-20220122090854435](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090854435.png)

![image-20220122090952559](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122090952559.png)

![image-20220122091018333](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091018333.png)

![image-20220122091037539](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091037539.png)

![image-20220122091109906](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091109906.png)

![image-20220122091155122](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091155122.png)

![image-20220122091218083](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091218083.png)

![image-20220122091400107](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091400107.png)

![image-20220122091457995](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091457995.png)

![image-20220122091641396](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091641396.png)

![image-20220122091719372](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091719372.png)

![image-20220122091846943](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091846943.png)

![image-20220122091903174](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091903174.png)

![image-20220122091910256](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122091910256.png)

![image-20220122092016111](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122092016111.png)

![image-20220122094949715](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122094949715.png)

![image-20220122095043049](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095043049.png)

![image-20220122095133996](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095133996.png)

![image-20220122095347569](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095347569.png)

![image-20220122095406384](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095406384.png)

![image-20220122095421842](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095421842.png)

![image-20220122095432128](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095432128.png)

![image-20220122095838423](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122095838423.png)

![image-20220122100159407](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122100159407.png)

![image-20220122100623130](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122100623130.png)

![image-20220122100925963](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122100925963.png)

![image-20220122102854211](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122102854211.png)

![image-20220122102902619](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122102902619.png)

![image-20220122102933749](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122102933749.png)

![image-20220122103007365](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103007365.png)

![image-20220122103122403](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103122403.png)

![image-20220122103219959](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103219959.png)

![image-20220122103330809](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103330809.png)

![image-20220122103344526](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103344526.png)

![image-20220122103411410](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103411410.png)

![image-20220122103455273](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103455273.png)

![image-20220122103538874](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103538874.png)

![image-20220122103906829](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103906829.png)

![image-20220122103936605](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122103936605.png)

![image-20220122104004795](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104004795.png)

![image-20220122104019921](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104019921.png)

![image-20220122104027247](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104027247.png)

![image-20220122104042007](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104042007.png)

![image-20220122104053524](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104053524.png)

![image-20220122104242167](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104242167.png)

![image-20220122104251673](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104251673.png)

![image-20220122104453649](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104453649.png)

![image-20220122104600137](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104600137.png)

![image-20220122104640585](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104640585.png)

![image-20220122104711506](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104711506.png)

![image-20220122104721520](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104721520.png)

![image-20220122104738253](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104738253.png)

![image-20220122104822538](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104822538.png)

![image-20220122104828876](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104828876.png)

![image-20220122104930013](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122104930013.png)

## 第5章 编程框架机理

第五章将学习到实现深度学习算法所使用的编程框架的工作机理。本章主要以TensorFlow为例介绍编程框架的运行机理，帮助同学理解大规模异构系统如何以计算图机制处理深度学习任务，依次讲解TF的设计原则，TF内部核心的计算图机制（包含计算图的自动求导、模型训练的检查点机制、计算图的复杂控制逻辑以及计算图的两种运行模式），TF实现架构与核心逻辑，最后从多个维度对主流编程框架进行对比。

![image-20220122114003871](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122114003871.png)

考虑三点：高性能、易开发、可移植。

![image-20220122114148728](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122114148728.png)

![image-20220122114437562](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122114437562.png)

![image-20220122114451523](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122114451523.png)

![image-20220122114837996](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122114837996.png)

![image-20220122115044455](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122115044455.png)

![image-20220122115058326](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122115058326.png)

![image-20220122115203980](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122115203980.png)

![image-20220122115428246](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220122115428246.png)

![image-20220123094206870](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123094206870.png)

![image-20220123094234036](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123094234036.png)

![image-20220123094318751](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123094318751.png)

![image-20220123094349339](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123094349339.png)

![image-20220123094823586](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123094823586.png)

![image-20220123095226337](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123095226337.png)

![image-20220123095303904](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123095303904.png)

![image-20220123095607333](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123095607333.png)

自动求导法：

对编程框架来说设计上比较友好，精度、速度都比较好。

![image-20220123100027766](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123100027766.png)

![image-20220123100215705](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123100215705.png)

![image-20220123101012004](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101012004.png)

![image-20220123101107363](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101107363.png)

![image-20220123101335965](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101335965.png)

![image-20220123101459033](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101459033.png)

![image-20220123101658397](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101658397.png)

![image-20220123101815378](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123101815378.png)

![image-20220123102111223](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123102111223.png)

![image-20220123102205476](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123102205476.png)

![image-20220123102248698](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123102248698.png)

![image-20220123103650467](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123103650467.png)

![image-20220123104031662](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123104031662.png)

 

![image-20220123104121342](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123104121342.png)

![image-20220123104248409](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123104248409.png)

![image-20220123104737084](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123104737084.png)

![image-20220123104914078](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123104914078.png)

![image-20220123105024183](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123105024183.png)

![image-20220123105228630](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123105228630.png)

![image-20220123105439140](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123105439140.png)

![image-20220123105614431](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123105614431.png)

![image-20220123111522102](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123111522102.png)

![image-20220123112039616](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112039616.png)

![image-20220123112128212](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112128212.png)

![image-20220123112221586](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112221586.png)

![image-20220123112237329](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112237329.png)

![image-20220123112638151](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112638151.png)

![image-20220123112728721](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112728721.png)

![image-20220123112855286](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112855286.png)

![image-20220123112954748](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123112954748.png)

![image-20220123113044412](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123113044412.png)

![image-20220123113123198](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123113123198.png)

![image-20220123113150730](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123113150730.png)

![image-20220123113256898](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123113256898.png)

TensorFlow系统实现

![image-20220123124907312](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123124907312.png)

session是用户和tensorflow运行的接口。

![image-20220123125135020](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125135020.png)

![image-20220123125226807](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125226807.png)

![image-20220123125309489](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125309489.png)

![image-20220123125334756](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125334756.png)

![image-20220123125400597](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125400597.png)

![image-20220123125416280](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125416280.png)

![image-20220123125633610](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125633610.png)

![image-20220123125725980](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125725980.png)

![image-20220123125759166](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125759166.png)

![image-20220123125909100](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123125909100.png)

![image-20220123130051356](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123130051356.png)

![image-20220123130058753](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123130058753.png)

![image-20220123130132188](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123130132188.png)

![image-20220123130213307](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123130213307.png)

![image-20220123130326839](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123130326839.png)

![image-20220123131028936](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131028936.png)

![image-20220123131057519](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131057519.png)

![image-20220123131140118](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131140118.png)

![image-20220123131207721](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131207721.png)

![image-20220123131221046](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131221046.png)

![image-20220123131300062](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131300062.png)

![image-20220123131337145](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131337145.png)

![image-20220123131416410](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131416410.png)

驱动范例

![image-20220123131844141](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131844141.png)

![image-20220123131929128](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123131929128.png)

![image-20220123132105911](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123132105911.png)

![image-20220123132125177](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123132125177.png)

![image-20220123132142335](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123132142335.png)

![image-20220123132209461](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123132209461.png)

![image-20220123132918176](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123132918176.png)

![image-20220123133038883](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133038883.png)

所谓开源开放，背后一定要有商业利益在背后推动才有可能获得成功。

![image-20220123133214776](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133214776.png)

![image-20220123133242821](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133242821.png)

![image-20220123133333083](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133333083.png)

![image-20220123133348371](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133348371.png)

![image-20220123133414920](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123133414920.png)

## 第6章 深度学习处理器原理

本章重点介绍深度学习处理器的基本原理，希望能引导大家设计出一个简单的具备有限功能的深度学习处理器，能很好地支持图像风格迁移所用的常见基本算子，我们称其为DLP（Deep Learning Processor），具体包含深度学习处理器概述、目标算法分析、深度学习处理器架构、优化设计以及性能评价。![image-20220123144128085](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144128085.png)

![image-20220123144246071](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144246071.png)

![image-20220123144254664](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144254664.png)

![image-20220123144550053](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144550053.png)

![image-20220123144700893](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144700893.png)

![image-20220123144718638](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144718638.png)

![image-20220123144827023](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123144827023.png)

![image-20220123145235429](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145235429.png)

![image-20220123145400979](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145400979.png)

![image-20220123145417857](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145417857.png)

![image-20220123145626987](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145626987.png)

![image-20220123145706420](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145706420.png)

![image-20220123145716821](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123145716821.png)

![image-20220123150014086](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123150014086.png)

ASIC是完成特定深度学习算法的处理器。

![image-20220123150200742](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123150200742.png)

![image-20220123150239380](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123150239380.png)

![image-20220123155329772](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155329772.png)

![image-20220123155406640](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155406640.png)

![image-20220123155508997](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155508997.png)

![image-20220123155557966](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155557966.png)

![image-20220123155644412](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155644412.png)

![image-20220123155711801](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155711801.png)

![image-20220123155721424](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155721424.png)

![image-20220123155745682](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155745682.png)

![image-20220123155808345](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155808345.png)

![image-20220123155836339](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155836339.png)

![image-20220123155848428](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155848428.png)

![image-20220123155859155](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155859155.png)

![image-20220123155943482](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155943482.png)

![image-20220123155959644](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123155959644.png)

![image-20220123160019539](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160019539.png)

![image-20220123160122951](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160122951.png)

![image-20220123160509864](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160509864.png)

![image-20220123160629094](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160629094.png)

![image-20220123160718659](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160718659.png)

![image-20220123160750310](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160750310.png)

![image-20220123160805945](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160805945.png)

![image-20220123160814147](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123160814147.png)

![image-20220123161103360](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123161103360.png)

![image-20220123161151240](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123161151240.png)

![image-20220123161215761](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123161215761.png)

图灵奖指令集的工作：

浮点数IEEE 754标准

RISC

![image-20220123161750866](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123161750866.png)

![image-20220123161958230](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123161958230.png)

![image-20220123162122834](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162122834.png)

![image-20220123162146965](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162146965.png)

![image-20220123162155061](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162155061.png)

![image-20220123162251971](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162251971.png)

![image-20220123162316930](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162316930.png)

![image-20220123162346319](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162346319.png)

![image-20220123162401221](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162401221.png)

![image-20220123162458998](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162458998.png)

![image-20220123162943982](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123162943982.png)

![image-20220123163047207](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163047207.png)

![image-20220123163118864](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163118864.png)

![image-20220123163139539](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163139539.png)

![image-20220123163305847](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163305847.png)

![image-20220123163347553](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163347553.png)

![image-20220123163420691](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163420691.png)

![image-20220123163652681](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163652681.png)

![image-20220123163724248](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163724248.png)

![image-20220123163918067](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163918067.png)

![image-20220123163936609](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123163936609.png)

![image-20220123164016272](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164016272.png)

![image-20220123164032226](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164032226.png)

![image-20220123164050795](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164050795.png)

![image-20220123164102271](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164102271.png)

![image-20220123164108737](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164108737.png)

![image-20220123164138499](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164138499.png)

![image-20220123164233702](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164233702.png)

![image-20220123164239976](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164239976.png)

![image-20220123164415450](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164415450.png)

![image-20220123164425480](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164425480.png)

![image-20220123164446368](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164446368.png)

![image-20220123164458062](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164458062.png)

![image-20220123164541116](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164541116.png)

![image-20220123164701143](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164701143.png)

![image-20220123164816487](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164816487.png)

![image-20220123164921663](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123164921663.png)

1k个运算是1000个，1M个运算是一百万个，1k个运算是十亿个，TOPS是每秒钟多少万亿次运算。

![image-20220123165140576](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123165140576.png)

![image-20220123165200625](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123165200625.png)

![image-20220123165234958](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123165234958.png)

![image-20220123165243357](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123165243357.png)

## 第7章 深度学习处理器架构

在上一章，我们教会大家如何设计一款基本的深度学习处理器，这是一个基本架构，要能满足工业界的实际需求，还需做进一步优化。因此，本周会详细介绍面向终端智能应用的单核深度学习处理器以及满足云端智能应用需求的多核深度学习处理器。

![image-20220123170303309](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123170303309.png)

![image-20220123170319534](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123170319534.png)

![image-20220123170931772](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123170931772.png)

![image-20220123170939872](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123170939872.png)

![image-20220123170950800](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123170950800.png)

![image-20220123171103041](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123171103041.png)

![image-20220123171153909](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123171153909.png)

![image-20220123171224123](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123171224123.png)

![image-20220123172535517](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172535517.png)

![image-20220123172604089](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172604089.png)

![image-20220123172650045](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172650045.png)

![image-20220123172719742](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172719742.png)

![image-20220123172736938](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172736938.png)

![image-20220123172752414](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172752414.png)

![image-20220123172807645](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172807645.png)

![image-20220123172824334](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172824334.png)

![image-20220123172848619](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172848619.png)

![image-20220123172948121](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123172948121.png)

![image-20220123173035572](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173035572.png)

![image-20220123173044774](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173044774.png)

![image-20220123173051836](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173051836.png)

![image-20220123173313176](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173313176.png)

![image-20220123173330642](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173330642.png)

![image-20220123173425576](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173425576.png)

![image-20220123173439152](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173439152.png)

![image-20220123173447421](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173447421.png)

![image-20220123173516980](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173516980.png)

![image-20220123173523616](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173523616.png)

![image-20220123173540565](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173540565.png)

![image-20220123173614672](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173614672.png)

![image-20220123173621950](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173621950.png)

![image-20220123173734728](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173734728.png)

![image-20220123173749924](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173749924.png)

![image-20220123173816400](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173816400.png)

![image-20220123173902401](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173902401.png)

![image-20220123173911686](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123173911686.png)

![image-20220123181121308](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220123181121308.png)

![image-20220124135047554](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135047554.png)

![image-20220124135102524](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135102524.png)

![image-20220124135117098](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135117098.png)

![image-20220124135133168](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135133168.png)

![image-20220124135330313](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135330313.png)

![image-20220124135609939](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135609939.png)

![image-20220124135748025](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135748025.png)

![image-20220124135756141](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135756141.png)

![image-20220124135803138](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135803138.png)

![image-20220124135823254](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124135823254.png)

![image-20220124140434543](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124140434543.png)

![image-20220124140453906](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124140453906.png)

![image-20220124140508821](C:\Users\wangweiying\AppData\Roaming\Typora\typora-user-images\image-20220124140508821.png)

## 第8章 智能编程语言

面向AI领域，作为连接智能编程框架和智能计算硬件的桥梁，智能编程语言既是实现编程框架算子的基础，也是对智能计算硬件高效编程的核心用户入口。本章将从智能计算系统抽象架构、编程模型、语言基础、编程接口、功能调试、性能调优以及系统级开发等方面展开介绍。

